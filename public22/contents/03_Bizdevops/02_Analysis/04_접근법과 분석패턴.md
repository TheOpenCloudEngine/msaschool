# 접근법과 분석패턴

### **Approach \#1: 마이크로서비스 아키텍처**

 초기의 마이크로서비스는 서비스의 자율성과 독립성, 서비스에 최적화된 저장소(Polyglot Persistence) 선택이
 가능한 아키텍처로 고안되었다. 그러나, 서비스간 호출 시, 동기식 API 방식 (Requeste & Response)을 주로 
사용함으로 인해 타임 커플링(Time Coupling)이라는 약점이 존재했다.
 
 타임 커플링된 서비스들은 서비스 블로킹(Blocking) 우려와 한 서비스에서 발생한 장애가 타 서비스로 전파될 수 있는
 약점을 가지고 있다. 이는 웹 스케일 기반 시스템에서는 치명적 단점으로, 이를 회로 차단(Circuit Breaking) 
 등의 방법으로 극복하려 하였다.
 
> ![](/img/03_Bizdevops/02/04/image22.png)

---

###  **Approach \#2: 이벤트 드리븐(Event Driven) 아키텍처**

 이를 보완한 것이 최근 각광받고 있는 이벤트 기반(EDA)의 3세대 마이크로서비스이다. 도메인에서 발생하는 
 이벤트를 분산된 큐를 통해 브로드캐스팅(BroadCasting)하고 Pub/Sub을 통해 상호 커뮤니케이션하는 
 아키텍처를 가진다.
 
> ![](/img/03_Bizdevops/02/04/image23.png)
 
 예를 들어, 주문이 발생하였을 때, 직접 배송팀에다 ‘’배송을 준비하세요.’라고 지시하는 것은 주문팀의 입장에서는 
그다지 중요한 것이 아니다. 주문팀은 배송팀이 배송을 하던 말던 관심이 없다는 것이다.
 
 REST방식(직접 호출)으로 서로 통신할 경우, 요청자는 다음 액션을 수행하기 위해 응답이 도착할 때까지 
기다려야 하는  블로킹(Blocking) 즉, 타임 커플링이 일어난다.
 
 만약, 주문팀이 발생한 사실에 대해 비동기 기반 큐(single Source Of Truth)에 “주문이 발생하였습니다.”
 라고 신고만 하고, 이어지는 액션을 배송팀이 알아서 수행해도 된다. 이처럼 발생한 사실을 ‘신고’하고, 신고된 사실을
 ‘구독’하는 패턴의 아키텍처가 이벤트 드리븐(Event Driven) (또는, 화이트보드 패턴) 아키텍처이다.
 
 그렇게 되면 1세대 MSA에서는 배송팀의 비즈니스 프로세스가 주문팀이 호출해 실행되던 방식이, 3세대 MSA에선 
 배송팀이 직접 이벤트에 반응하여 실행하는 방식으로 실행 주체가 바뀌게 된다.
 
 신설된 마케팅팀 또한, 주문팀의 주문 발생으로 수행해야 할 비즈니스 프로세스가 있다면, 단순하게 주문팀의 
 “주문이 발송하였습니다.” 라는 이벤트에 대해 마케팅팀도 반응하여 수행하면 된다는 것이다.
 
---

### **Approach \#2: 이벤트 드리븐(Event Driven) 아키텍처**

이벤트 드리븐 아키텍처를 적용함으로써 얻어지는 장점 중의 하나는 폴리글랏 퍼시스턴스이다. 각 마이크로서비스 팀들은 
이제 나만의 데이터베이스를 가질 수 있다. 자기 만의 스토리지를 자기만의 아키텍처를 적용하여 구성할 수 있다는 것이다.

주문팀은 사용자의 주문 정보만 관리하고, 상품팀은 전혀 다른 관점으로 상품의 재고 정보만을 관리한다. 배송팀 또한, 
주문 ID에 대해 배송 상태만 가진다.

사업 초기, 모노리식 구조에선 간결한 스키마 였으나 서포팅 업무가 늘어남에 따라 주문팀 테이블의 컬럼이 많아지고, 
여러 팀의 참조 Constraints로 인해, 점진적으로 분리가 불가능한 캐노니컬 모델 구조로 변모하게 된다.

![](/img/03_Bizdevops/02/04/image24.png)

이는 곧 대대적인 합의와 대대적인 리팩토링을 통해서만 수정이 가능한 비용 집약적 결과를 양산하게 된다.

그러나, 이벤트드리븐 아키텍처에서는 이벤트의 원천을 통해 각 팀이 필요에 의해 디자인하는, 디자인 책임이 분산된 환경을
 추구함으로 모노리식에서의 데이터 참조 이슈가 없어진다.

---

### **Approach \#3: BizDevOops 프로세스**

비즈데브옵스는 비즈니스 유저를 뜻하는 ‘비즈’와 ‘데브옵스’가 결합된 의미로, 고객의 니즈를 인풋으로, 이를 개발하고 운영하는
것에 있어 단절을 최소화하는 것을 목적으로 한다.

조직적으로는 Vertically aligned 되어 있어야 하고, 도구적으로는 이벤트스토밍을 적용해 그 결과 모델을 코드화하여,
자동화된 DevOps환경에서 운영하는 선 순환적 사이클이 비즈데브옵스 프로세스이다.

이를 수행하는 방식(A way of working)이 흔히 알고 있는 스크럼으로, 스크럼과 위에 언급된 3가지 프랙티스가 버물러
질 때, 비로소 ‘Agile’이 실현되는 것이다.

![](/img/03_Bizdevops/02/04/image25.png)